<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradingView-like Chart Interface</title>
    <link href="https://cdn.jsdelivr.net/npm/@tradingview/charting-library@latest/charting-library.min.css" rel="stylesheet">
    <style>
        #chart {
            height: 100vh;
        }
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>

    <!-- The chart will be displayed here -->
    <div id="chart"></div>

    <script src="https://cdn.jsdelivr.net/npm/@tradingview/charting-library@latest/charting-library.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script>
        // Set up chart options
        const chartOptions = {
            container: document.getElementById("chart"),
            libraryPath: 'https://cdn.jsdelivr.net/npm/@tradingview/charting-library@latest/charting-library/',
            locale: 'en',
            theme: 'Light', // You can switch between 'Light' or 'Dark' theme
            studiesOverrides: {
                'moving_averages.ma1.color': '#FF0000', // Example: override moving average color
            },
        };

        // Initialize the chart
        const widget = new TradingView.widget(chartOptions);

        // Fetch data from the provided JSON URL
        async function fetchChartData() {
            const response = await axios.get('https://github.com/trustosas/market-replay/raw/refs/heads/main/eurusd15.json');
            const data = response.data;

            // Convert the data into the format expected by TradingView's chart
            const formattedData = data.map(item => ({
                time: item.timestamp * 1000, // convert timestamp to milliseconds
                open: item.open,
                high: item.high,
                low: item.low,
                close: item.close
            }));

            // Use the chart's API to add data
            widget.onChartReady(function() {
                widget.chart.addDataSource({
                    type: 'candlestick',
                    data: formattedData,
                    symbol: 'EUR/USD',
                    interval: '15',
                });
            });
        }

        // Run the fetch function
        fetchChartData();
    </script>

</body>
</html>
